<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto API Analyzer</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.1.2/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <style>
        .high-severity { background-color: #FF6B6B; }
        .medium-severity { background-color: #FFD166; }
        .low-severity { background-color: #06D6A0; }
        .quantum-vulnerable { background-color: #F9C74F; }
        .severity-icon { width: 24px; height: 24px; }
        .tooltip { visibility: hidden; background-color: black; color: #fff; text-align: center; border-radius: 5px; padding: 5px; position: absolute; z-index: 1; }
        .table-row:hover .tooltip { visibility: visible; }
    </style>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto p-4">
        <header class="text-center py-8">
            <h1 class="text-4xl font-semibold text-blue-600">Crypto API Analyzer</h1>
            <p class="mt-2 text-lg text-gray-600">Analyze cryptographic APIs in your code to detect vulnerabilities</p>
        </header>

        <!-- Upload Section -->
        <div class="mb-8">
            <h2 class="text-xl font-semibold text-gray-700">Upload Your Code for Analysis</h2>
            <p class="text-gray-500 mb-4">Upload JavaScript, Java, or Python code files to check for cryptographic vulnerabilities.</p>
            <form id="uploadForm" action="/analyze" method="POST" enctype="multipart/form-data">
                <input type="file" name="file" class="border p-2 rounded-md" accept=".js, .java, .py" required />
                <button type="submit" class="bg-blue-500 text-white px-6 py-2 rounded-md mt-4">Analyze</button>
            </form>
        </div>

        <!-- Importance Section -->
        <div class="mb-8">
            <h3 class="text-xl font-semibold text-gray-700">Why Secure Cryptography Matters</h3>
            <p class="text-gray-600 mt-4">
                Cryptographic APIs play a critical role in protecting sensitive data. Insecure implementations can expose your system to attacks like data breaches, man-in-the-middle attacks, and more. This tool helps you check if your cryptographic code follows best practices and avoids common security pitfalls.
            </p>
        </div>

        <!-- Results Table -->
        <div class="overflow-x-auto">
            <table class="min-w-full bg-white border border-gray-300 shadow-lg">
                <thead>
                    <tr class="bg-blue-500 text-white">
                        <th class="py-2 px-4">File</th>
                        <th class="py-2 px-4">Language</th>
                        <th class="py-2 px-4">Match</th>
                        <th class="py-2 px-4">Line</th>
                        <th class="py-2 px-4">Severity</th>
                        <th class="py-2 px-4">Quantum Vulnerable</th>
                    </tr>
                </thead>
                <tbody id="resultsBody">
                    <!-- Results will be injected here dynamically -->
                </tbody>
            </table>
        </div>

        <!-- Footer -->
        <footer class="text-center py-8 text-gray-600">
            <p>&copy; 2025 Crypto API Analyzer. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // Sample results data (to simulate actual backend data)
        const results = [
            {
                file: 'TestCrypto.java',
                language: 'Java',
                match: 'Cipher.getInstance("AES")',
                line: 16,
                severity: 'High',
                quantum_vulnerable: true,
                explanation: "AES should be used with a secure key management system to avoid vulnerabilities."
            },
            {
                file: 'TestCrypto.java',
                language: 'Java',
                match: 'KeyPairGenerator.getInstance("RSA")',
                line: 23,
                severity: 'Medium',
                quantum_vulnerable: false,
                explanation: "RSA keys should be of sufficient length and properly managed."
            }
        ];

        // Function to populate the results table with color-coding and tooltips
        function populateResults() {
            const resultsBody = document.getElementById('resultsBody');
            results.forEach(result => {
                const row = document.createElement('tr');
                row.classList.add('table-row');
                row.classList.add(
                    result.severity.toLowerCase() === 'high' ? 'high-severity' :
                    result.severity.toLowerCase() === 'medium' ? 'medium-severity' :
                    'low-severity'
                );
                row.classList.add(result.quantum_vulnerable ? 'quantum-vulnerable' : '');

                row.innerHTML = `
                    <td class="py-2 px-4">${result.file}</td>
                    <td class="py-2 px-4">${result.language}</td>
                    <td class="py-2 px-4">${result.match}</td>
                    <td class="py-2 px-4">${result.line}</td>
                    <td class="py-2 px-4">
                        <span class="font-bold">${result.severity}</span>
                        <img src="${result.severity.toLowerCase() === 'high' ? 'high-icon.png' : result.severity.toLowerCase() === 'medium' ? 'medium-icon.png' : 'low-icon.png'}" alt="severity icon" class="severity-icon ml-2" />
                        <div class="tooltip">${result.explanation}</div>
                    </td>
                    <td class="py-2 px-4">${result.quantum_vulnerable ? 'Yes' : 'No'}</td>
                `;
                resultsBody.appendChild(row);
            });
        }

        // Call the function to populate the results table on page load
        window.onload = populateResults;
    </script>
</body>
</html>
