<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>SPECTRA ‚Äî Quantum Security Intelligence</title>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@700;800;900&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet"/>
<style>
:root{
  --bg:#03060F;--bg2:#080D1A;--bg3:#0D1525;
  --surface:rgba(13,21,37,0.85);--surface2:rgba(8,13,26,0.9);
  --border:rgba(99,179,237,0.1);--border2:rgba(99,179,237,0.28);
  --blue:#3B82F6;--cyan:#22D3EE;--violet:#8B5CF6;
  --green:#10B981;--red:#EF4444;--orange:#F59E0B;--yellow:#FCD34D;
  --text:#E2E8F0;--text2:#94A3B8;--text3:#475569;
  --font-h:'Syne',sans-serif;--font-m:'Space Mono',monospace;--font-b:'DM Sans',sans-serif;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{font-size:14px;scroll-behavior:smooth}
body{background:var(--bg);color:var(--text);font-family:var(--font-b);min-height:100vh;overflow-x:hidden}
button,input{font-family:inherit;cursor:pointer}
canvas{display:block}
::-webkit-scrollbar{width:4px;height:4px}
::-webkit-scrollbar-thumb{background:rgba(99,179,237,0.18);border-radius:2px}

/* ‚îÄ‚îÄ BG GRID ‚îÄ‚îÄ */
.bg-grid{position:fixed;inset:0;z-index:0;pointer-events:none;
  background-image:linear-gradient(rgba(59,130,246,0.03) 1px,transparent 1px),
  linear-gradient(90deg,rgba(59,130,246,0.03) 1px,transparent 1px);
  background-size:44px 44px}

/* ‚îÄ‚îÄ LAYOUT ‚îÄ‚îÄ */
.shell{display:flex;min-height:100vh;position:relative;z-index:1}
.sidebar{
  width:58px;min-height:100vh;position:fixed;left:0;top:0;z-index:200;
  background:rgba(8,13,26,0.96);border-right:1px solid var(--border);
  display:flex;flex-direction:column;align-items:center;padding:14px 0 14px;gap:6px;
  backdrop-filter:blur(16px)
}
.logo-mark{
  width:34px;height:34px;margin-bottom:14px;border-radius:9px;
  background:linear-gradient(135deg,var(--blue),var(--violet));
  display:flex;align-items:center;justify-content:center;
  font-family:var(--font-h);font-size:14px;font-weight:900;color:#fff;
  box-shadow:0 0 22px rgba(59,130,246,0.45);flex-shrink:0
}
.nav-btn{
  width:40px;height:40px;border-radius:8px;border:1px solid transparent;
  background:none;color:var(--text3);display:flex;align-items:center;justify-content:center;
  transition:all 0.18s ease;position:relative
}
.nav-btn:hover{background:rgba(59,130,246,0.1);color:var(--text2);border-color:var(--border)}
.nav-btn.active{background:rgba(34,211,238,0.12);color:var(--cyan);border-color:rgba(34,211,238,0.3)}
.nav-btn svg{width:18px;height:18px;flex-shrink:0}
.tip{
  position:absolute;left:52px;top:50%;transform:translateY(-50%);
  background:var(--bg3);border:1px solid var(--border2);border-radius:6px;
  padding:5px 11px;font-family:var(--font-m);font-size:10px;color:var(--text);
  white-space:nowrap;opacity:0;pointer-events:none;transition:opacity 0.18s;z-index:500;
  box-shadow:0 4px 20px rgba(0,0,0,0.5)
}
.nav-btn:hover .tip{opacity:1}

.main{margin-left:58px;flex:1;display:flex;flex-direction:column;min-height:100vh}

/* ‚îÄ‚îÄ TOPBAR ‚îÄ‚îÄ */
.topbar{
  height:52px;display:flex;align-items:center;justify-content:space-between;
  padding:0 26px;background:rgba(3,6,15,0.92);border-bottom:1px solid var(--border);
  position:sticky;top:0;z-index:100;backdrop-filter:blur(14px)
}
.brand{display:flex;align-items:center;gap:12px}
.brand-name{
  font-family:var(--font-h);font-size:19px;font-weight:900;letter-spacing:1px;
  background:linear-gradient(90deg,var(--cyan),var(--blue) 50%,var(--violet));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text
}
.brand-sub{font-family:var(--font-m);font-size:9px;color:var(--text3);letter-spacing:2.5px}
.topbar-right{display:flex;align-items:center;gap:18px}
.api-pill{
  display:flex;align-items:center;gap:6px;padding:4px 12px;border-radius:20px;
  border:1px solid var(--border);font-family:var(--font-m);font-size:9px;letter-spacing:1px;
  transition:all 0.3s
}
.api-pill.online{border-color:rgba(16,185,129,0.35);background:rgba(16,185,129,0.07);color:var(--green)}
.api-pill.offline{border-color:rgba(239,68,68,0.3);background:rgba(239,68,68,0.07);color:var(--red)}
.api-pill.checking{border-color:var(--border);color:var(--text3)}
.api-dot{width:6px;height:6px;border-radius:50%;background:currentColor}
.api-pill.online .api-dot{animation:pulse-d 2s infinite;box-shadow:0 0 6px currentColor}
@keyframes pulse-d{0%,100%{box-shadow:0 0 4px var(--green)}50%{box-shadow:0 0 10px var(--green),0 0 18px rgba(16,185,129,0.3)}}
.clock{font-family:var(--font-m);font-size:11px;color:var(--text2)}

/* ‚îÄ‚îÄ PAGE WRAPPER ‚îÄ‚îÄ */
.page{display:none;padding:26px 28px 36px;flex:1;animation:pin .3s ease}
.page.active{display:block}
@keyframes pin{from{opacity:0;transform:translateY(7px)}to{opacity:1;transform:translateY(0)}}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   HOME PAGE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.home-hero{text-align:center;padding:52px 0 36px;position:relative}
.home-hero h1{
  font-family:var(--font-h);font-size:54px;font-weight:900;line-height:1.06;
  letter-spacing:-1.5px;margin-bottom:18px
}
.home-hero h1 .grad{
  background:linear-gradient(135deg,var(--cyan) 0%,var(--blue) 45%,var(--violet) 100%);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text
}
.home-hero p{font-size:16px;color:var(--text2);max-width:600px;margin:0 auto 32px;line-height:1.7;font-weight:500}
.hero-actions{display:flex;justify-content:center;gap:12px;flex-wrap:wrap}
.btn-cta{
  padding:13px 32px;background:linear-gradient(135deg,var(--blue),var(--violet));
  border:none;border-radius:9px;color:#fff;font-weight:700;font-size:15px;
  transition:all 0.2s;box-shadow:0 0 24px rgba(59,130,246,0.35)
}
.btn-cta:hover{transform:translateY(-2px);box-shadow:0 8px 32px rgba(59,130,246,0.5)}
.btn-ghost{
  padding:13px 32px;background:transparent;border:1px solid var(--border2);
  border-radius:9px;color:var(--text);font-weight:600;font-size:15px;transition:all 0.2s
}
.btn-ghost:hover{background:rgba(59,130,246,0.08);border-color:var(--cyan)}

/* STATS ROW */
.stats-row{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:44px}
.stat-c{
  background:var(--surface);border:1px solid var(--border);border-radius:12px;
  padding:20px 16px;text-align:center;transition:all 0.2s
}
.stat-c:hover{border-color:var(--border2);transform:translateY(-2px);box-shadow:0 8px 32px rgba(0,0,0,0.3)}
.stat-num{font-family:var(--font-h);font-size:40px;font-weight:900;line-height:1}
.stat-label{font-family:var(--font-m);font-size:9px;letter-spacing:2px;color:var(--text2);margin-top:7px}
.stat-sub{font-size:11px;color:var(--text3);margin-top:5px;line-height:1.4}

/* WHY SECTION */
.section-head{margin-bottom:28px}
.section-tag{font-family:var(--font-m);font-size:10px;letter-spacing:3px;color:var(--cyan);margin-bottom:10px}
.section-title{font-family:var(--font-h);font-size:30px;font-weight:900;line-height:1.2;margin-bottom:10px}
.section-desc{font-size:14px;color:var(--text2);max-width:580px;line-height:1.65}

.why-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-bottom:44px}
.why-card{
  background:var(--surface);border:1px solid var(--border);border-radius:14px;
  padding:22px;transition:all 0.25s ease;cursor:default;overflow:hidden;position:relative
}
.why-card::after{
  content:'';position:absolute;inset:0;opacity:0;transition:opacity 0.3s;border-radius:14px;
  background:radial-gradient(circle at 20% 20%,var(--glow-c,rgba(59,130,246,0.1)) 0%,transparent 70%)
}
.why-card:hover{border-color:var(--border2);transform:translateY(-3px);box-shadow:0 12px 40px rgba(0,0,0,0.35)}
.why-card:hover::after{opacity:1}
.wc-icon{font-size:30px;margin-bottom:14px}
.wc-title{font-family:var(--font-h);font-size:15px;font-weight:800;margin-bottom:8px;color:var(--text)}
.wc-body{font-size:12px;color:var(--text2);line-height:1.65}
.wc-tag{
  display:inline-block;margin-top:12px;font-family:var(--font-m);font-size:9px;
  padding:3px 9px;border-radius:3px;letter-spacing:1px
}
.tag-red{background:rgba(239,68,68,0.12);border:1px solid rgba(239,68,68,0.3);color:var(--red)}
.tag-orange{background:rgba(245,158,11,0.1);border:1px solid rgba(245,158,11,0.3);color:var(--orange)}
.tag-violet{background:rgba(139,92,246,0.12);border:1px solid rgba(139,92,246,0.3);color:#A78BFA}
.tag-green{background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.25);color:var(--green)}
.tag-blue{background:rgba(59,130,246,0.1);border:1px solid rgba(59,130,246,0.25);color:var(--blue)}

/* INTERACTIVE CRACK DEMO */
.crack-section{margin-bottom:44px}
.crack-card{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:28px;overflow:hidden}
.crack-top{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:22px;gap:20px;flex-wrap:wrap}
.crack-info h3{font-family:var(--font-h);font-size:20px;font-weight:800;margin-bottom:6px}
.crack-info p{font-size:13px;color:var(--text2);max-width:480px;line-height:1.6}
.algo-tabs{display:flex;gap:8px;flex-wrap:wrap}
.atab{
  padding:8px 16px;border-radius:7px;border:1px solid var(--border);
  font-family:var(--font-m);font-size:10px;letter-spacing:1px;
  color:var(--text2);background:none;transition:all 0.2s
}
.atab:hover{border-color:var(--border2);color:var(--text)}
.atab.on{background:rgba(59,130,246,0.15);border-color:var(--blue);color:var(--cyan)}
.crack-body{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.algo-detail{padding:18px;background:rgba(0,0,0,0.3);border-radius:10px;border:1px solid var(--border)}
.algo-big-name{font-family:var(--font-h);font-size:22px;font-weight:900;margin-bottom:8px}
.algo-desc-text{font-size:12px;color:var(--text2);line-height:1.65;margin-bottom:14px}
.algo-facts{display:flex;flex-direction:column;gap:7px}
.fact-row{display:flex;justify-content:space-between;align-items:center;padding:5px 0;border-bottom:1px solid rgba(255,255,255,0.04)}
.fact-row:last-child{border:none}
.fact-lbl{font-family:var(--font-m);font-size:9px;color:var(--text3);letter-spacing:1px}
.fact-val{font-family:var(--font-m);font-size:11px;font-weight:700}

.time-vis{padding:18px;background:rgba(0,0,0,0.3);border-radius:10px;border:1px solid var(--border)}
.tv-label{font-family:var(--font-m);font-size:9px;letter-spacing:2px;color:var(--text3);margin-bottom:16px}
.time-bars{display:flex;flex-direction:column;gap:12px}
.tb-row{display:flex;align-items:center;gap:10px}
.tb-lbl{font-family:var(--font-m);font-size:10px;color:var(--text2);width:100px;flex-shrink:0;line-height:1.3}
.tb-track{flex:1;height:26px;background:rgba(255,255,255,0.04);border-radius:5px;overflow:hidden;position:relative}
.tb-fill{height:100%;border-radius:5px;display:flex;align-items:center;padding:0 10px;justify-content:flex-end;
  transition:width 0.9s cubic-bezier(0.34,1.56,0.64,1)}
.tb-fill span{font-family:var(--font-m);font-size:9px;font-weight:700;color:#fff;white-space:nowrap}
.fill-green{background:linear-gradient(90deg,#059669,var(--green));box-shadow:0 0 10px rgba(16,185,129,0.3)}
.fill-orange{background:linear-gradient(90deg,#D97706,var(--orange));box-shadow:0 0 10px rgba(245,158,11,0.3)}
.fill-red{background:linear-gradient(90deg,#DC2626,var(--red));box-shadow:0 0 10px rgba(239,68,68,0.3);animation:flk 1.8s ease-in-out infinite}
@keyframes flk{0%,100%{opacity:1}60%{opacity:0.72}}
.fill-violet{background:linear-gradient(90deg,#6D28D9,var(--violet));box-shadow:0 0 10px rgba(139,92,246,0.3)}
.quantum-alert{
  margin-top:14px;padding:10px 14px;border-radius:8px;
  font-family:var(--font-m);font-size:10px;display:flex;align-items:center;gap:8px;line-height:1.5
}
.alert-danger{background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.28);color:var(--red)}
.alert-safe{background:rgba(16,185,129,0.08);border:1px solid rgba(16,185,129,0.22);color:var(--green)}
.alert-warn{background:rgba(245,158,11,0.08);border:1px solid rgba(245,158,11,0.25);color:var(--orange)}

/* TIMELINE */
.timeline{display:flex;align-items:center;gap:0;margin-bottom:44px;overflow-x:auto;padding-bottom:6px}
.tl-step{display:flex;align-items:center;flex-shrink:0}
.tl-node{
  display:flex;flex-direction:column;align-items:center;gap:8px;padding:16px 14px;
  background:var(--surface);border:1px solid var(--border);border-radius:10px;
  min-width:130px;text-align:center;transition:all 0.2s
}
.tl-node:hover{border-color:var(--border2);transform:translateY(-2px)}
.tl-icon{font-size:24px}
.tl-title{font-family:var(--font-h);font-size:11px;font-weight:800;line-height:1.3}
.tl-sub{font-size:10px;color:var(--text2);line-height:1.4}
.tl-arrow{color:var(--text3);font-size:18px;padding:0 8px;flex-shrink:0}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   SCANNER PAGE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.scanner-wrap{display:grid;grid-template-columns:290px 1fr;gap:18px;margin-bottom:22px}
.scan-panel{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:20px}
.panel-hd{font-family:var(--font-m);font-size:10px;letter-spacing:2px;color:var(--cyan);margin-bottom:14px}

.ex-files{display:flex;flex-direction:column;gap:6px;margin-bottom:14px}
.ex-file{
  display:flex;align-items:center;gap:10px;padding:9px 12px;
  border-radius:8px;border:1px solid var(--border);background:none;
  text-align:left;width:100%;transition:all 0.18s
}
.ex-file:hover{border-color:var(--border2);background:rgba(59,130,246,0.06)}
.ex-file.sel{border-color:var(--cyan);background:rgba(34,211,238,0.07)}
.ef-icon{font-size:18px;flex-shrink:0}
.ef-txt{flex:1;min-width:0}
.ef-name{font-family:var(--font-m);font-size:11px;color:var(--text);font-weight:700}
.ef-desc{font-size:10px;color:var(--text2);margin-top:2px}
.ef-b{font-family:var(--font-m);font-size:8px;padding:2px 6px;border-radius:3px;flex-shrink:0;letter-spacing:.5px}

.divider{height:1px;background:var(--border);margin:12px 0}
.upload-z{
  border:1px dashed rgba(59,130,246,0.28);border-radius:8px;
  padding:16px;text-align:center;transition:all 0.2s;margin-bottom:14px
}
.upload-z:hover,.upload-z.dov{border-color:var(--blue);background:rgba(59,130,246,0.05)}
.upload-z .uz-txt{font-family:var(--font-m);font-size:10px;color:var(--text2);letter-spacing:1px}
.upload-z .uz-sub{font-size:10px;color:var(--text3);margin-top:3px}

.scan-meta{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:14px}
.meta-box{padding:9px 10px;background:rgba(0,0,0,0.3);border-radius:7px;border:1px solid var(--border)}
.mb-lbl{font-family:var(--font-m);font-size:8px;letter-spacing:1px;color:var(--text3);display:block;margin-bottom:2px}
.mb-val{font-family:var(--font-m);font-size:16px;color:var(--text);font-weight:700;display:block}

.scan-btn{
  width:100%;padding:12px;border-radius:8px;
  border:1px solid rgba(59,130,246,0.4);
  background:linear-gradient(135deg,rgba(59,130,246,0.18),rgba(139,92,246,0.18));
  color:var(--text);font-family:var(--font-m);font-size:11px;letter-spacing:2px;
  transition:all 0.2s;display:flex;align-items:center;justify-content:center;gap:8px
}
.scan-btn:hover:not(:disabled){
  background:linear-gradient(135deg,rgba(59,130,246,0.32),rgba(139,92,246,0.32));
  box-shadow:0 0 22px rgba(59,130,246,0.3);transform:translateY(-1px)
}
.scan-btn:disabled{opacity:0.42;cursor:not-allowed}
.scan-btn svg{width:16px;height:16px;color:var(--cyan);flex-shrink:0}

.prog-wrap{margin-top:12px}
.prog-lbl{font-family:var(--font-m);font-size:9px;letter-spacing:1px;color:var(--text3);margin-bottom:5px}
.prog-track{height:3px;background:rgba(255,255,255,0.05);border-radius:2px;overflow:hidden}
.prog-fill{height:100%;width:0%;background:linear-gradient(90deg,var(--blue),var(--violet));border-radius:2px;transition:width .1s linear;box-shadow:0 0 6px rgba(59,130,246,0.4)}

/* CODE VIEWER */
.code-view-wrap{background:var(--surface);border:1px solid var(--border);border-radius:12px;overflow:hidden;display:flex;flex-direction:column}
.cv-head{
  display:flex;align-items:center;justify-content:space-between;
  padding:11px 16px;border-bottom:1px solid var(--border);background:rgba(0,0,0,0.35);flex-shrink:0
}
.cv-file{font-family:var(--font-m);font-size:10px;color:var(--cyan)}
.cv-counts{display:flex;gap:7px}
.cv-badge{font-family:var(--font-m);font-size:9px;padding:2px 8px;border-radius:3px}
.cvb-bad{background:rgba(239,68,68,0.12);border:1px solid rgba(239,68,68,0.3);color:var(--red)}
.cvb-ok{background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.25);color:var(--green)}
.code-body{font-family:var(--font-m);font-size:12px;line-height:1.75;max-height:390px;overflow-y:auto;background:#060A12}
.cl{display:flex;border-left:2px solid transparent}
.cl:hover{background:rgba(255,255,255,0.02)}
.cl.vuln{background:rgba(239,68,68,0.07);border-left-color:var(--red)}
.cl.safe-l{background:rgba(16,185,129,0.06);border-left-color:var(--green)}
.ln{color:var(--text3);min-width:36px;padding:0 8px 0 10px;user-select:none;font-size:10px;flex-shrink:0}
.lc{padding:0 12px 0 2px;color:#94A3B8;word-break:break-all}
.cl.vuln .lc{color:#FCA5A5}
.cl.safe-l .lc{color:#6EE7B7}
.code-empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:64px;color:var(--text3);font-family:var(--font-m);font-size:11px;gap:12px;text-align:center;background:#060A12}
.ces-icon{font-size:36px;opacity:0.35}

/* ‚îÄ‚îÄ RESULTS ‚îÄ‚îÄ */
.results-area{margin-top:0}
.posture-banner{
  border-radius:12px;padding:20px 24px;margin-bottom:20px;
  display:flex;align-items:center;gap:22px;border:1px solid;flex-wrap:wrap
}
.posture-banner.CRITICAL_RISK{background:rgba(239,68,68,0.08);border-color:rgba(239,68,68,0.32)}
.posture-banner.HIGH_RISK{background:rgba(245,158,11,0.07);border-color:rgba(245,158,11,0.28)}
.posture-banner.MODERATE_RISK{background:rgba(245,158,11,0.05);border-color:rgba(245,158,11,0.18)}
.posture-banner.LOW_RISK{background:rgba(16,185,129,0.06);border-color:rgba(16,185,129,0.22)}
.pb-grade{font-family:var(--font-h);font-size:52px;font-weight:900;min-width:66px;text-align:center;line-height:1}
.pb-info{flex:1;min-width:200px}
.pb-readiness{font-family:var(--font-h);font-size:17px;font-weight:800;margin-bottom:4px}
.pb-score{font-family:var(--font-m);font-size:10px;color:var(--text2);margin-bottom:10px}
.pb-pills{display:flex;flex-wrap:wrap;gap:7px}
.pb-pill{font-family:var(--font-m);font-size:9px;padding:3px 10px;border-radius:3px}

/* CHARTS ROW ‚Äî after posture */
.charts-row{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px;margin-bottom:22px}
.chart-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:20px}
.chart-hd{font-family:var(--font-m);font-size:10px;letter-spacing:2px;color:var(--cyan);margin-bottom:16px}
.chart-sub{font-size:11px;color:var(--text2);margin-top:10px;text-align:center;line-height:1.5}

/* Severity donut */
.donut-wrap{position:relative;width:130px;height:130px;margin:0 auto}
.donut-legend{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-top:12px}
.dl-item{display:flex;align-items:center;gap:5px;font-family:var(--font-m);font-size:9px;color:var(--text2)}
.dl-dot{width:8px;height:8px;border-radius:2px;flex-shrink:0}

/* Before/After risk */
.ba-rows{display:flex;flex-direction:column;gap:14px}
.ba-block{}
.ba-hd{display:flex;justify-content:space-between;align-items:center;margin-bottom:5px}
.ba-lbl{font-family:var(--font-m);font-size:10px;color:var(--text2)}
.ba-score{font-family:var(--font-h);font-size:16px;font-weight:900}
.ba-track{height:20px;background:rgba(255,255,255,0.04);border-radius:5px;overflow:hidden}
.ba-fill{height:100%;border-radius:5px;display:flex;align-items:center;
  padding-right:8px;justify-content:flex-end;
  transition:width 1.1s cubic-bezier(0.34,1.56,0.64,1)}
.ba-fill span{font-family:var(--font-m);font-size:9px;font-weight:700;color:#fff}
.ba-improvement{
  margin-top:12px;padding:10px 12px;border-radius:7px;text-align:center;
  background:rgba(16,185,129,0.08);border:1px solid rgba(16,185,129,0.22)
}
.ba-imp-num{font-family:var(--font-h);font-size:26px;font-weight:900;color:var(--green)}
.ba-imp-lbl{font-family:var(--font-m);font-size:9px;color:var(--text2);letter-spacing:1px}

/* Risk meter */
.meter-svg-wrap{display:flex;justify-content:center;margin-bottom:6px}
.meter-readout{text-align:center}
.mr-val{font-family:var(--font-h);font-size:34px;font-weight:900}
.mr-lbl{font-family:var(--font-m);font-size:9px;color:var(--text3);letter-spacing:1.5px;margin-top:2px}

/* ‚òÖ FINDINGS ‚Äî MAIN STAR FEATURE ‚òÖ */
.findings-section-hd{
  display:flex;align-items:center;justify-content:space-between;margin-bottom:16px
}
.findings-hd-title{font-family:var(--font-h);font-size:20px;font-weight:900}
.findings-count{font-family:var(--font-m);font-size:11px;color:var(--text2)}
.findings-list{display:flex;flex-direction:column;gap:14px}

.finding-card{
  background:var(--bg2);border:1px solid var(--border);border-radius:12px;
  overflow:hidden;animation:pin 0.4s ease both;transition:box-shadow 0.2s
}
.finding-card:hover{box-shadow:0 6px 28px rgba(0,0,0,0.4)}
.finding-card.sev-CRITICAL{border-left:3px solid var(--red)}
.finding-card.sev-HIGH{border-left:3px solid var(--orange)}
.finding-card.sev-MEDIUM{border-left:3px solid var(--yellow)}
.finding-card.sev-LOW{border-left:3px solid var(--green)}
.finding-card.sev-INFO{border-left:3px solid var(--blue)}

.fc-head{
  padding:14px 18px 12px;display:flex;align-items:flex-start;justify-content:space-between;
  border-bottom:1px solid var(--border);gap:12px
}
.fc-left{}
.fc-id-row{display:flex;align-items:center;gap:8px;margin-bottom:6px}
.fc-id{font-family:var(--font-m);font-size:9px;color:var(--text3)}
.fc-cve{font-family:var(--font-m);font-size:9px;color:var(--text3)}
.sev-b{font-family:var(--font-m);font-size:9px;font-weight:700;padding:3px 8px;border-radius:3px;letter-spacing:.8px;flex-shrink:0}
.sb-CRITICAL{background:rgba(239,68,68,0.15);border:1px solid rgba(239,68,68,0.4);color:var(--red)}
.sb-HIGH{background:rgba(245,158,11,0.12);border:1px solid rgba(245,158,11,0.35);color:var(--orange)}
.sb-MEDIUM{background:rgba(252,211,77,0.1);border:1px solid rgba(252,211,77,0.3);color:var(--yellow)}
.sb-LOW{background:rgba(16,185,129,0.08);border:1px solid rgba(16,185,129,0.25);color:var(--green)}
.sb-INFO{background:rgba(59,130,246,0.1);border:1px solid rgba(59,130,246,0.25);color:var(--blue)}
.fc-algo{font-family:var(--font-h);font-size:18px;font-weight:900;color:var(--text);margin-bottom:5px}
.fc-desc{font-size:12px;color:var(--text2);line-height:1.6}
.fc-loc{font-family:var(--font-m);font-size:10px;color:var(--text3);margin-top:5px}

.fc-body{padding:14px 18px}

/* AI Explanation box */
.ai-explain{
  padding:11px 14px;background:rgba(59,130,246,0.06);border:1px solid rgba(59,130,246,0.15);
  border-radius:8px;font-size:12px;color:var(--text2);line-height:1.65;margin-bottom:14px;
  position:relative
}
.ai-explain::before{
  content:'‚ú¶ AI INSIGHT';position:absolute;top:-9px;left:12px;
  font-family:var(--font-m);font-size:8px;letter-spacing:1.5px;color:var(--cyan);
  background:var(--bg2);padding:0 6px
}

/* ‚òÖ‚òÖ‚òÖ THE STAR: Code diff ‚òÖ‚òÖ‚òÖ */
.fix-section{
  background:rgba(0,0,0,0.4);border:1px solid rgba(139,92,246,0.22);border-radius:10px;overflow:hidden
}
.fix-header{
  display:flex;align-items:center;justify-content:space-between;
  padding:10px 14px;border-bottom:1px solid rgba(139,92,246,0.15);
  background:rgba(139,92,246,0.08)
}
.fix-hd-left{display:flex;align-items:center;gap:10px}
.fix-lbl{font-family:var(--font-m);font-size:9px;letter-spacing:1.5px;color:#A78BFA}
.fix-arrow{color:var(--text3);font-size:12px}
.fix-algo-name{font-family:var(--font-h);font-size:14px;font-weight:900;color:#C4B5FD}
.fix-meta-badges{display:flex;gap:6px;flex-wrap:wrap}
.fix-meta-b{font-family:var(--font-m);font-size:8px;padding:2px 7px;border-radius:3px;letter-spacing:.5px}
.fmb-std{background:rgba(34,211,238,0.1);border:1px solid rgba(34,211,238,0.25);color:var(--cyan)}
.fmb-perf{background:rgba(245,158,11,0.1);border:1px solid rgba(245,158,11,0.25);color:var(--orange)}
.fmb-pqc{background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.25);color:var(--green)}

/* Diff viewer ‚Äî THE STAR */
.diff-tabs{display:flex;border-bottom:1px solid rgba(139,92,246,0.12)}
.diff-tab{
  padding:7px 16px;font-family:var(--font-m);font-size:10px;letter-spacing:1px;
  color:var(--text3);border:none;background:none;border-bottom:2px solid transparent;
  transition:all 0.18s;cursor:pointer
}
.diff-tab.on{color:var(--cyan);border-bottom-color:var(--cyan)}
.diff-tab:hover:not(.on){color:var(--text2)}
.diff-pane{display:none;font-family:var(--font-m);font-size:11px;
  max-height:220px;overflow-y:auto;background:#03060F}
.diff-pane.on{display:block}
.diff-l{padding:2px 14px;line-height:1.75;white-space:pre-wrap;word-break:break-all}
.diff-l.minus{background:rgba(239,68,68,0.1);color:#FCA5A5;border-left:2px solid var(--red)}
.diff-l.plus{background:rgba(16,185,129,0.08);color:#6EE7B7;border-left:2px solid var(--green)}
.diff-l.ctx{color:#64748B}
.diff-l.hunk{color:var(--cyan);background:rgba(34,211,238,0.05);border-left:2px solid rgba(34,211,238,0.28)}
.diff-l.head{color:#94A3B8;background:rgba(255,255,255,0.03);padding:6px 14px;border-bottom:1px solid var(--border)}

/* Empty / error states */
.scan-empty{
  background:var(--surface);border:1px solid var(--border);border-radius:12px;
  padding:48px;text-align:center;color:var(--text3);font-family:var(--font-m);font-size:11px;
  display:flex;flex-direction:column;align-items:center;gap:14px;letter-spacing:1px
}
.se-icon{font-size:40px;opacity:0.3}
.scan-error{
  padding:16px 18px;background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.25);
  border-radius:10px;font-family:var(--font-m);font-size:11px;color:var(--red);margin-top:16px
}
.scan-success{
  padding:16px 18px;background:rgba(16,185,129,0.07);border:1px solid rgba(16,185,129,0.22);
  border-radius:10px;font-family:var(--font-m);font-size:12px;color:var(--green);margin-top:0;
  text-align:center;display:flex;flex-direction:column;align-items:center;gap:8px
}
.ss-check{font-size:28px}

/* LOADING OVERLAY */
.loading-overlay{
  position:fixed;inset:0;background:rgba(3,6,15,0.92);backdrop-filter:blur(14px);
  z-index:1000;display:flex;align-items:center;justify-content:center;
  opacity:0;pointer-events:none;transition:opacity 0.3s
}
.loading-overlay.on{opacity:1;pointer-events:all}
.loading-modal{
  background:var(--bg2);border:1px solid rgba(59,130,246,0.28);border-radius:16px;
  padding:40px 56px;text-align:center;box-shadow:0 0 60px rgba(59,130,246,0.15);max-width:380px;width:90%
}
.lm-icon{width:56px;height:56px;margin:0 auto 18px;animation:spin 3s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.lm-title{font-family:var(--font-h);font-size:15px;font-weight:900;letter-spacing:2px;margin-bottom:6px}
.lm-sub{font-family:var(--font-m);font-size:10px;color:var(--text2);letter-spacing:1px;margin-bottom:20px;min-height:16px}
.lm-bar-track{height:3px;background:rgba(255,255,255,0.06);border-radius:2px;overflow:hidden;margin-bottom:7px}
.lm-bar{height:100%;width:0%;background:linear-gradient(90deg,var(--blue),var(--violet),var(--cyan));border-radius:2px;transition:width 0.1s linear;box-shadow:0 0 8px rgba(34,211,238,0.4)}
.lm-pct{font-family:var(--font-m);font-size:11px;color:var(--cyan)}

@media(max-width:1080px){.charts-row{grid-template-columns:1fr 1fr}}
@media(max-width:960px){.scanner-wrap{grid-template-columns:1fr}.crack-body{grid-template-columns:1fr}.why-grid{grid-template-columns:1fr 1fr}.stats-row{grid-template-columns:1fr 1fr}}
@media(max-width:640px){.home-hero h1{font-size:34px}.why-grid{grid-template-columns:1fr}.stats-row{grid-template-columns:1fr 1fr}.charts-row{grid-template-columns:1fr}.page{padding:14px}}
</style>
</head>
<body>

<div class="bg-grid"></div>

<!-- LOADING OVERLAY -->
<div class="loading-overlay" id="loverlay">
  <div class="loading-modal">
    <div class="lm-icon">
      <svg viewBox="0 0 56 56" fill="none">
        <circle cx="28" cy="28" r="26" stroke="url(#sg)" stroke-width="2"/>
        <circle cx="28" cy="28" r="18" stroke="url(#sg)" stroke-width="1.5" stroke-dasharray="5 4"/>
        <circle cx="28" cy="28" r="4" fill="#22D3EE"/>
        <defs><linearGradient id="sg" x1="0" y1="0" x2="56" y2="56">
          <stop stop-color="#3B82F6"/><stop offset="1" stop-color="#8B5CF6"/>
        </linearGradient></defs>
      </svg>
    </div>
    <div class="lm-title">QUANTUM SCAN</div>
    <div class="lm-sub" id="lm-sub">Uploading file‚Ä¶</div>
    <div class="lm-bar-track"><div class="lm-bar" id="lm-bar"></div></div>
    <div class="lm-pct" id="lm-pct">0%</div>
  </div>
</div>

<div class="shell">
  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="logo-mark">S</div>
    <button class="nav-btn active" data-page="home" onclick="nav('home')">
      <svg viewBox="0 0 20 20" fill="none"><path d="M3 9.5L10 3l7 6.5V17a1 1 0 01-1 1H4a1 1 0 01-1-1V9.5z" stroke="currentColor" stroke-width="1.5"/><path d="M8 18v-6h4v6" stroke="currentColor" stroke-width="1.5"/></svg>
      <span class="tip">Home</span>
    </button>
    <button class="nav-btn" data-page="scanner" onclick="nav('scanner')">
      <svg viewBox="0 0 20 20" fill="none"><circle cx="9" cy="9" r="6" stroke="currentColor" stroke-width="1.5"/><path d="M15 15l3 3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M6 9h6M9 6v6" stroke="currentColor" stroke-width="1.3" stroke-linecap="round"/></svg>
      <span class="tip">Code Scanner</span>
    </button>
  </aside>

  <div class="main">
    <!-- TOPBAR -->
    <header class="topbar">
      <div class="brand">
        <div class="brand-name">SPECTRA</div>
        <div class="brand-sub">QUANTUM SECURITY</div>
      </div>
      <div class="topbar-right">
        <div class="api-pill checking" id="api-pill">
          <div class="api-dot"></div>
          <span id="api-lbl">CHECKING‚Ä¶</span>
        </div>
        <div class="clock" id="clock">--:--:--</div>
      </div>
    </header>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         PAGE: HOME
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <section class="page active" id="page-home">
      <div class="home-hero">
        <h1>Your code is <span class="grad">quantum-vulnerable.</span><br>We prove it.</h1>
        <p>Quantum computers will shatter RSA, ECDSA, and Diffie-Hellman in seconds. SPECTRA scans your code, explains the threat, and rewrites your crypto to NIST post-quantum standards ‚Äî automatically.</p>
        <div class="hero-actions">
          <button class="btn-cta" onclick="nav('scanner')">‚ö° Scan Your Code</button>
          <button class="btn-ghost" onclick="document.getElementById('why-section').scrollIntoView({behavior:'smooth'})">See the Threat ‚Üí</button>
        </div>
      </div>

      <!-- STATS -->
      <div class="stats-row">
        <div class="stat-c" style="--acc:var(--red)">
          <div class="stat-num" style="color:var(--red)">2030</div>
          <div class="stat-label">HARVEST NOW DEADLINE</div>
          <div class="stat-sub">Estimated year quantum computers break RSA-2048</div>
        </div>
        <div class="stat-c">
          <div class="stat-num" style="color:var(--orange)">~70%</div>
          <div class="stat-label">VULNERABLE CODEBASES</div>
          <div class="stat-sub">Of production systems still use quantum-breakable crypto</div>
        </div>
        <div class="stat-c">
          <div class="stat-num" style="color:var(--cyan)">3</div>
          <div class="stat-label">NIST PQC STANDARDS</div>
          <div class="stat-sub">FIPS 203/204/205 ‚Äî finalized Aug 2024, ready to deploy</div>
        </div>
        <div class="stat-c">
          <div class="stat-num" style="color:var(--green)">Now</div>
          <div class="stat-label">TIME TO MIGRATE</div>
          <div class="stat-sub">"Harvest now, decrypt later" attacks are already happening</div>
        </div>
      </div>

      <!-- WHY SECTION -->
      <div id="why-section">
        <div class="section-head">
          <div class="section-tag">// WHY IT MATTERS</div>
          <div class="section-title">The Quantum Clock Is Ticking</div>
          <div class="section-desc">Shor's algorithm runs on a quantum computer and factors large numbers exponentially faster than any classical machine. Every RSA key, every elliptic curve ‚Äî done in seconds.</div>
        </div>
        <div class="why-grid" style="margin-bottom:44px">
          <div class="why-card" style="--glow-c:rgba(239,68,68,0.15)">
            <div class="wc-icon">‚öõÔ∏è</div>
            <div class="wc-title">Shor's Algorithm Breaks RSA</div>
            <div class="wc-body">A large enough quantum computer runs Shor's algorithm to factor the product of two huge primes in polynomial time ‚Äî the same problem that makes RSA secure. RSA-2048 falls in hours, not centuries.</div>
            <span class="wc-tag tag-red">CRITICAL THREAT</span>
          </div>
          <div class="why-card" style="--glow-c:rgba(245,158,11,0.12)">
            <div class="wc-icon">üì°</div>
            <div class="wc-title">"Harvest Now, Decrypt Later"</div>
            <div class="wc-body">Nation-state actors are <strong>already collecting</strong> encrypted traffic today. When quantum computers mature, they'll retroactively decrypt everything they've harvested ‚Äî your secrets from today, exposed tomorrow.</div>
            <span class="wc-tag tag-orange">ACTIVE RIGHT NOW</span>
          </div>
          <div class="why-card" style="--glow-c:rgba(139,92,246,0.12)">
            <div class="wc-icon">üîê</div>
            <div class="wc-title">PQC Algorithms Are Ready</div>
            <div class="wc-body">NIST finalized three post-quantum standards in August 2024: ML-KEM (CRYSTALS-Kyber), ML-DSA (CRYSTALS-Dilithium), and SLH-DSA (SPHINCS+). Drop-in replacements exist. The only blocker is migrating your code.</div>
            <span class="wc-tag tag-violet">FIPS 203 ¬∑ 204 ¬∑ 205</span>
          </div>
          <div class="why-card" style="--glow-c:rgba(59,130,246,0.1)">
            <div class="wc-icon">üî¨</div>
            <div class="wc-title">Grover's Algorithm Halves Symmetric Keys</div>
            <div class="wc-body">Even symmetric crypto isn't immune. Grover's algorithm searches an unsorted database in ‚àöN steps. AES-128 becomes effectively AES-64 against a quantum attacker. AES-256 stays safe ‚Äî but SHA-1 and MD5 are finished.</div>
            <span class="wc-tag tag-blue">AFFECTS HASHING</span>
          </div>
          <div class="why-card" style="--glow-c:rgba(16,185,129,0.1)">
            <div class="wc-icon">üõ°Ô∏è</div>
            <div class="wc-title">Your Code Has the Answer</div>
            <div class="wc-body">The migration path is clear. Every vulnerable algorithm has a proven quantum-safe replacement. SPECTRA finds where you're using RSA, ECDSA, DH, SHA-1, and tells you exactly what line to change and what to write instead.</div>
            <span class="wc-tag tag-green">SOLVABLE NOW</span>
          </div>
          <div class="why-card" style="--glow-c:rgba(34,211,238,0.08)">
            <div class="wc-icon">‚è∞</div>
            <div class="wc-title">The 10-Year Migration Window</div>
            <div class="wc-body">Large organisations take 10-15 years to fully migrate cryptographic infrastructure. IBM, Google, and NIST all agree: the migration must start now. Every day of delay shortens your safety margin.</div>
            <span class="wc-tag tag-orange">START TODAY</span>
          </div>
        </div>
      </div>

      <!-- INTERACTIVE CRACK DEMO -->
      <div class="crack-section">
        <div class="section-head">
          <div class="section-tag">// INTERACTIVE DEMO</div>
          <div class="section-title">How Long to Break Your Crypto?</div>
          <div class="section-desc">Select an algorithm and see how a quantum computer compares to the world's fastest classical supercomputer.</div>
        </div>
        <div class="crack-card">
          <div class="algo-tabs" id="algo-tabs">
            <button class="atab on" onclick="selectAlgo(0,this)">RSA-2048</button>
            <button class="atab" onclick="selectAlgo(1,this)">RSA-1024</button>
            <button class="atab" onclick="selectAlgo(2,this)">ECDSA P-256</button>
            <button class="atab" onclick="selectAlgo(3,this)">AES-256</button>
            <button class="atab" onclick="selectAlgo(4,this)">SHA-1</button>
            <button class="atab" onclick="selectAlgo(5,this)">ML-KEM-768</button>
          </div>
          <div style="height:14px"></div>
          <div class="crack-body">
            <div class="algo-detail">
              <div class="algo-big-name" id="ad-name">RSA-2048</div>
              <div class="algo-desc-text" id="ad-desc">Public-key encryption based on the difficulty of factoring the product of two large primes. The most widely deployed asymmetric algorithm in the world.</div>
              <div class="algo-facts">
                <div class="fact-row"><span class="fact-lbl">TYPE</span><span class="fact-val" id="ad-type" style="color:var(--text2)">Asymmetric</span></div>
                <div class="fact-row"><span class="fact-lbl">KEY SIZE</span><span class="fact-val" id="ad-key" style="color:var(--cyan)">2048-bit</span></div>
                <div class="fact-row"><span class="fact-lbl">CLASSICAL SECURITY</span><span class="fact-val" id="ad-classic" style="color:var(--green)">~112-bit</span></div>
                <div class="fact-row"><span class="fact-lbl">QUANTUM SECURITY</span><span class="fact-val" id="ad-quantum">0-bit</span></div>
                <div class="fact-row"><span class="fact-lbl">THREAT ALGO</span><span class="fact-val" id="ad-threat" style="color:var(--orange)">Shor's Algorithm</span></div>
                <div class="fact-row"><span class="fact-lbl">STATUS</span><span class="fact-val" id="ad-status">‚Äî</span></div>
              </div>
            </div>
            <div class="time-vis">
              <div class="tv-label">TIME TO CRACK ¬∑ CLASSICAL vs QUANTUM</div>
              <div class="time-bars" id="time-bars">
                <!-- populated by JS -->
              </div>
              <div class="quantum-alert" id="qalert"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- HOW IT WORKS TIMELINE -->
      <div>
        <div class="section-head">
          <div class="section-tag">// HOW SPECTRA WORKS</div>
          <div class="section-title">From Vulnerable to Quantum-Safe in Seconds</div>
        </div>
        <div class="timeline">
          <div class="tl-step">
            <div class="tl-node">
              <div class="tl-icon">üìÅ</div>
              <div class="tl-title">Upload Code</div>
              <div class="tl-sub">Java, Python, JS, Go, Rust‚Ä¶</div>
            </div>
          </div>
          <div class="tl-arrow">‚Üí</div>
          <div class="tl-step">
            <div class="tl-node">
              <div class="tl-icon">üîç</div>
              <div class="tl-title">Static Scan</div>
              <div class="tl-sub">AST-level crypto detection</div>
            </div>
          </div>
          <div class="tl-arrow">‚Üí</div>
          <div class="tl-step">
            <div class="tl-node">
              <div class="tl-icon">‚ú¶</div>
              <div class="tl-title">AI Analysis</div>
              <div class="tl-sub">Context-aware explanation</div>
            </div>
          </div>
          <div class="tl-arrow">‚Üí</div>
          <div class="tl-step">
            <div class="tl-node">
              <div class="tl-icon">‚ö°</div>
              <div class="tl-title">PQC Fix</div>
              <div class="tl-sub">NIST-compliant code diff</div>
            </div>
          </div>
          <div class="tl-arrow">‚Üí</div>
          <div class="tl-step">
            <div class="tl-node">
              <div class="tl-icon">üõ°Ô∏è</div>
              <div class="tl-title">Quantum-Safe</div>
              <div class="tl-sub">ML-KEM / ML-DSA ready</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         PAGE: SCANNER
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <section class="page" id="page-scanner">
      <div style="margin-bottom:20px">
        <div class="section-tag">// QUANTUM VULNERABILITY SCANNER</div>
        <div style="font-family:var(--font-h);font-size:26px;font-weight:900;margin-bottom:6px">Code Analysis</div>
        <div style="font-size:13px;color:var(--text2)">Select a preloaded example or upload your own file. The scanner detects quantum-vulnerable cryptography and generates AI-powered PQC migration code.</div>
      </div>

      <div class="scanner-wrap">
        <!-- LEFT PANEL -->
        <div class="scan-panel">
          <div class="panel-hd">EXAMPLE FILES</div>
          <div class="ex-files" id="ex-files-list">
            <!-- populated by JS -->
          </div>
          <div class="divider"></div>
          <div class="panel-hd">OR UPLOAD YOUR OWN</div>
          <div class="upload-z" id="upload-z" onclick="document.getElementById('file-inp').click()">
            <div style="font-size:22px;margin-bottom:7px">üìÇ</div>
            <div class="uz-txt">DROP FILE OR CLICK TO UPLOAD</div>
            <div class="uz-sub">.py .js .ts .go .rs .java .kt .cs</div>
            <input type="file" id="file-inp" hidden accept=".py,.js,.ts,.tsx,.jsx,.go,.rs,.java,.kt,.cs,.cpp,.c,.rb,.php,.swift,.txt,.env,.yml,.yaml,.toml" onchange="handleUpload(event)"/>
          </div>
          <div class="scan-meta">
            <div class="meta-box">
              <span class="mb-lbl">LINES</span>
              <span class="mb-val" id="meta-lines">‚Äî</span>
            </div>
            <div class="meta-box">
              <span class="mb-lbl">FINDINGS</span>
              <span class="mb-val" id="meta-findings">‚Äî</span>
            </div>
            <div class="meta-box" style="grid-column:1/-1">
              <span class="mb-lbl">GRADE</span>
              <span class="mb-val" id="meta-grade" style="font-size:24px">‚Äî</span>
            </div>
          </div>
          <button class="scan-btn" id="scan-btn" onclick="runScan()" disabled>
            <svg viewBox="0 0 20 20" fill="none"><circle cx="10" cy="10" r="7" stroke="currentColor" stroke-width="1.5"/><path d="M10 7v3l2 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
            SELECT A FILE FIRST
          </button>
          <div class="prog-wrap" id="prog-wrap" style="display:none">
            <div class="prog-lbl">SCANNING ‚Äî <span id="prog-pct">0</span>%</div>
            <div class="prog-track"><div class="prog-fill" id="prog-fill"></div></div>
          </div>
        </div>

        <!-- CODE VIEWER -->
        <div class="code-view-wrap">
          <div class="cv-head">
            <span class="cv-file" id="cv-file">no file selected</span>
            <div class="cv-counts" id="cv-counts"></div>
          </div>
          <div class="code-body" id="code-body">
            <div class="code-empty-state">
              <div class="ces-icon">‚óà</div>
              <span>Select an example file or upload your own to begin</span>
            </div>
          </div>
        </div>
      </div>

      <!-- RESULTS -->
      <div class="results-area" id="results-area">
        <div class="scan-empty" id="scan-empty-state">
          <div class="se-icon">‚ö°</div>
          <span>SCAN RESULTS WILL APPEAR HERE</span>
          <span style="font-size:10px;color:var(--text3)">Select a file and click RUN SCAN to analyse</span>
        </div>
      </div>
    </section>
  </div>
</div>

<script>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   SPECTRA ‚Äî Frontend Script
   Backend: POST http://127.0.0.1:8000/scan
            GET  http://127.0.0.1:8000/health
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

const API = 'http://127.0.0.1:8000';

/* ‚îÄ‚îÄ STATE ‚îÄ‚îÄ */
const S = {
  page: 'home',
  file: null,
  source: '',
  results: [],
  selectedExample: null,
};

/* ‚îÄ‚îÄ EXAMPLE FILES embedded as strings ‚îÄ‚îÄ */
const EXAMPLES = [
  {
    name:'TestCrypto_RSA_1024.java',
    desc:'Weak RSA 1024-bit key generation',
    badge:'CRITICAL',
    badgeClass:'tag-red',
    icon:'‚òï',
    code:`import java.security.KeyPairGenerator;
import java.security.KeyPair;

public class TestCryptoRSA1024 {

    public static void main(String[] args) throws Exception {

        KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");
        keyGen.initialize(1024);
        KeyPair pair = keyGen.generateKeyPair();

        System.out.println("Generated weak RSA 1024 key pair.");
    }
}`
  },
  {
    name:'TestCrypto_RSA_2048.java',
    desc:'RSA 2048 ‚Äî still quantum-vulnerable',
    badge:'HIGH',
    badgeClass:'tag-orange',
    icon:'‚òï',
    code:`import java.security.KeyPairGenerator;
import java.security.KeyPair;

public class TestCryptoRSA2048 {

    public static void main(String[] args) throws Exception {

        KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");
        keyGen.initialize(2048);
        KeyPair pair = keyGen.generateKeyPair();

        System.out.println("Generated RSA 2048 key pair.");
    }
}`
  },
  {
    name:'TestCrypto_Mixed.java',
    desc:'RSA-1024 + SHA-1 mixed vulnerabilities',
    badge:'CRITICAL',
    badgeClass:'tag-red',
    icon:'‚òï',
    code:`import java.security.KeyPairGenerator;
import java.security.KeyPair;
import java.security.MessageDigest;

public class TestCryptoMixed {

    public static void main(String[] args) throws Exception {

        KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");
        keyGen.initialize(1024);
        KeyPair pair = keyGen.generateKeyPair();

        MessageDigest md = MessageDigest.getInstance("SHA-1");
        byte[] hash = md.digest("test".getBytes());

        System.out.println("Multiple crypto operations executed.");
    }
}`
  },
  {
    name:'TestCrypto_SHA1.java',
    desc:'SHA-1 hash ‚Äî Grover vulnerable',
    badge:'MEDIUM',
    badgeClass:'tag-orange',
    icon:'‚òï',
    code:`import java.security.MessageDigest;

public class TestCryptoSHA1 {

    public static void main(String[] args) throws Exception {

        MessageDigest md = MessageDigest.getInstance("SHA-1");
        byte[] hash = md.digest("sensitive-data".getBytes());
        String result = bytesToHex(hash);
        System.out.println("SHA-1 Hash: " + result);
    }

    private static String bytesToHex(byte[] bytes) {
        StringBuilder sb = new StringBuilder();
        for (byte b : bytes) sb.append(String.format("%02x", b));
        return sb.toString();
    }
}`
  },
  {
    name:'TestCrypto_Kyber.java',
    desc:'ML-KEM (Kyber512) ‚Äî quantum-safe',
    badge:'SAFE',
    badgeClass:'tag-green',
    icon:'üîê',
    code:`import org.openquantumsafe.KeyEncapsulation;

public class TestCryptoKyber {

    public static void main(String[] args) throws Exception {

        KeyEncapsulation kem = new KeyEncapsulation("Kyber512");
        byte[] publicKey = kem.generateKeyPair().getPublic();

        System.out.println("Generated Kyber key pair.");
    }
}`
  },
];

/* ‚îÄ‚îÄ ALGO CRACK DATA ‚îÄ‚îÄ */
const ALGOS = [
  {
    name:'RSA-2048', type:'Asymmetric / KEM', key:'2048-bit',
    classicSec:'~112-bit (safe)', quantumSec:'0-bit üíÄ', threat:"Shor's Algorithm",
    status:'QUANTUM-BROKEN', statusColor:'var(--red)',
    desc:'Public-key encryption based on the difficulty of factoring the product of two large primes. The most widely deployed asymmetric algorithm in the world.',
    bars:[
      {label:'Classical\nsupercomputer',fill:'fill-green',w:2,text:'~300 trillion years'},
      {label:'Quantum computer\n(future)',fill:'fill-red',w:98,text:'~8 hours'},
    ],
    alert:{cls:'alert-danger',icon:'üí•',msg:"Shor's algorithm reduces RSA-2048 to hours on a cryptographically relevant quantum computer."}
  },
  {
    name:'RSA-1024', type:'Asymmetric / KEM', key:'1024-bit',
    classicSec:'~80-bit (weak)', quantumSec:'0-bit üíÄ', threat:"Shor's Algorithm",
    status:'BROKEN (CLASSICAL+QUANTUM)', statusColor:'var(--red)',
    desc:'An older, weaker variant of RSA already considered insecure against classical computers. Catastrophically broken by quantum computers.',
    bars:[
      {label:'Classical\nsupercomputer',fill:'fill-orange',w:18,text:'~1000 years'},
      {label:'Quantum computer\n(future)',fill:'fill-red',w:98,text:'~minutes'},
    ],
    alert:{cls:'alert-danger',icon:'üí•',msg:'RSA-1024 is already deprecated by NIST for classical reasons. A quantum computer breaks it in minutes.'}
  },
  {
    name:'ECDSA P-256', type:'Asymmetric / Signing', key:'256-bit EC',
    classicSec:'~128-bit (safe)', quantumSec:'0-bit üíÄ', threat:"Shor's Algorithm",
    status:'QUANTUM-BROKEN', statusColor:'var(--red)',
    desc:'Elliptic Curve Digital Signature Algorithm. Shorter keys than RSA for the same classical security, but equally vulnerable to quantum attacks via Shor\'s algorithm on the discrete log problem.',
    bars:[
      {label:'Classical\nsupercomputer',fill:'fill-green',w:3,text:'Practically impossible'},
      {label:'Quantum computer\n(future)',fill:'fill-red',w:94,text:'~1 hour'},
    ],
    alert:{cls:'alert-danger',icon:'üí•',msg:"Shor's algorithm also solves the elliptic curve discrete logarithm problem, breaking ECDSA entirely."}
  },
  {
    name:'AES-256', type:'Symmetric / Cipher', key:'256-bit',
    classicSec:'256-bit (very safe)', quantumSec:'128-bit (safe)', threat:"Grover's Algorithm",
    status:'QUANTUM-SAFE', statusColor:'var(--green)',
    desc:'Block cipher symmetric encryption. Grover\'s algorithm provides a quadratic speedup on brute-force, effectively halving the key length ‚Äî but 256-bit AES remains secure at 128-bit quantum equivalent.',
    bars:[
      {label:'Classical\nsupercomputer',fill:'fill-green',w:2,text:'Practically impossible'},
      {label:'Quantum computer\n(future)',fill:'fill-orange',w:22,text:'~2^128 operations (still safe)'},
    ],
    alert:{cls:'alert-safe',icon:'‚úÖ',msg:"AES-256 survives Grover's attack with ~128-bit effective security ‚Äî still considered safe."}
  },
  {
    name:'SHA-1', type:'Hash Function', key:'160-bit output',
    classicSec:'Broken (collision)', quantumSec:'0-bit üíÄ', threat:"Grover's Algorithm + Classical",
    status:'FULLY BROKEN', statusColor:'var(--red)',
    desc:'SHA-1 was already broken classically ‚Äî Google demonstrated a practical SHA-1 collision in 2017. Grover\'s algorithm reduces its quantum security further. Do not use SHA-1.',
    bars:[
      {label:'Classical\n(collision)',fill:'fill-red',w:92,text:'Broken since 2017'},
      {label:'Quantum computer\n(preimage)',fill:'fill-red',w:98,text:'~2^80 operations'},
    ],
    alert:{cls:'alert-danger',icon:'üí•',msg:'SHA-1 is fully broken. SHAttered attack (2017) proved practical collisions. Replace with SHA-3-256 or SHA-256 immediately.'}
  },
  {
    name:'ML-KEM-768', type:'Post-Quantum / KEM', key:'~1184-byte pk',
    classicSec:'‚â•178-bit', quantumSec:'‚â•166-bit', threat:'None Known',
    status:'QUANTUM-SAFE (FIPS 203)', statusColor:'var(--green)',
    desc:'CRYSTALS-Kyber. NIST FIPS 203 standard. A key encapsulation mechanism based on the hardness of the Module Learning with Errors (MLWE) problem ‚Äî no known quantum algorithm threatens it.',
    bars:[
      {label:'Classical\nsupercomputer',fill:'fill-violet',w:3,text:'Practically impossible'},
      {label:'Quantum computer\n(future)',fill:'fill-violet',w:4,text:'Still practically impossible'},
    ],
    alert:{cls:'alert-safe',icon:'üîê',msg:'ML-KEM-768 is the recommended drop-in replacement for RSA/ECDH. Standardised by NIST as FIPS 203 in 2024.'}
  },
];

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   NAVIGATION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function nav(id) {
  document.querySelectorAll('.nav-btn').forEach(b=>b.classList.toggle('active',b.dataset.page===id));
  document.querySelectorAll('.page').forEach(p=>p.classList.toggle('active',p.id==='page-'+id));
  S.page=id;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   CLOCK
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
(function clock(){
  const el=document.getElementById('clock');
  setInterval(()=>{
    const n=new Date(),p=v=>String(v).padStart(2,'0');
    if(el)el.textContent=`${p(n.getUTCHours())}:${p(n.getUTCMinutes())}:${p(n.getUTCSeconds())} UTC`;
  },1000);
})();

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   API HEALTH CHECK
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
async function checkApi(){
  const pill=document.getElementById('api-pill');
  const lbl=document.getElementById('api-lbl');
  try{
    const r=await fetch(API+'/health',{signal:AbortSignal.timeout(3500)});
    if(r.ok){
      pill.className='api-pill online';
      if(lbl)lbl.textContent='API ONLINE';
    } else {
      pill.className='api-pill offline';
      if(lbl)lbl.textContent='API ERROR';
    }
  } catch {
    pill.className='api-pill offline';
    if(lbl)lbl.textContent='API OFFLINE';
  }
}
checkApi();
setInterval(checkApi, 15000);

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   INTERACTIVE CRACK DEMO
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function selectAlgo(idx, btn){
  document.querySelectorAll('.atab').forEach(b=>b.classList.remove('on'));
  btn.classList.add('on');
  const a=ALGOS[idx];
  setText('ad-name',a.name);
  setText('ad-desc',a.desc);
  setText('ad-type',a.type);
  setText('ad-key',a.key);
  setText('ad-classic',a.classicSec);
  const qEl=document.getElementById('ad-quantum');
  if(qEl){qEl.textContent=a.quantumSec;qEl.style.color=a.quantumSec.includes('üíÄ')?'var(--red)':'var(--green)';}
  setText('ad-threat',a.threat);
  const sEl=document.getElementById('ad-status');
  if(sEl){sEl.textContent=a.status;sEl.style.color=a.statusColor;}
  // bars
  const barsEl=document.getElementById('time-bars');
  if(barsEl){
    barsEl.innerHTML=a.bars.map(b=>`
      <div class="tb-row">
        <div class="tb-lbl">${b.label.replace('\n','<br>')}</div>
        <div class="tb-track">
          <div class="tb-fill ${b.fill}" style="width:0%"><span>${b.text}</span></div>
        </div>
      </div>`).join('');
    // animate after render
    setTimeout(()=>{
      barsEl.querySelectorAll('.tb-fill').forEach((el,i)=>{
        el.style.width=a.bars[i].w+'%';
      });
    },30);
  }
  const qalert=document.getElementById('qalert');
  if(qalert){
    qalert.className='quantum-alert '+a.alert.cls;
    qalert.innerHTML=`<span>${a.alert.icon}</span><span>${a.alert.msg}</span>`;
  }
}
// init first
document.addEventListener('DOMContentLoaded',()=>selectAlgo(0,document.querySelector('.atab')));

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   EXAMPLE FILES INIT
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
document.addEventListener('DOMContentLoaded',()=>{
  const list=document.getElementById('ex-files-list');
  if(!list)return;
  EXAMPLES.forEach((ex,i)=>{
    const btn=document.createElement('button');
    btn.className='ex-file';
    btn.dataset.idx=i;
    btn.innerHTML=`
      <div class="ef-icon">${ex.icon}</div>
      <div class="ef-txt">
        <div class="ef-name">${ex.name}</div>
        <div class="ef-desc">${ex.desc}</div>
      </div>
      <span class="ef-b ${ex.badgeClass}">${ex.badge}</span>`;
    btn.onclick=()=>selectExample(i);
    list.appendChild(btn);
  });
});

function selectExample(idx){
  document.querySelectorAll('.ex-file').forEach((b,i)=>b.classList.toggle('sel',i===idx));
  const ex=EXAMPLES[idx];
  S.file=new File([ex.code], ex.name, {type:'text/plain'});
  S.source=ex.code;
  S.selectedExample=idx;
  renderCode(ex.code, ex.name);
  setText('meta-lines', ex.code.split('\n').length);
  setText('meta-findings','‚Äî');
  setText('meta-grade','‚Äî');
  document.getElementById('meta-grade').style.color='var(--text)';
  const btn=document.getElementById('scan-btn');
  btn.disabled=false;
  btn.innerHTML=`<svg viewBox="0 0 20 20" fill="none"><circle cx="10" cy="10" r="7" stroke="currentColor" stroke-width="1.5"/><path d="M10 7v3l2 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>RUN QUANTUM SCAN`;
  document.getElementById('scan-empty-state').style.display='flex';
  document.getElementById('results-area').innerHTML=`<div class="scan-empty" id="scan-empty-state"><div class="se-icon">‚ö°</div><span>READY TO SCAN: ${ex.name}</span><span style="font-size:10px;color:var(--text3)">Click RUN QUANTUM SCAN to analyse</span></div>`;
}

function handleUpload(evt){
  const file=evt.target.files[0];
  if(!file)return;
  document.querySelectorAll('.ex-file').forEach(b=>b.classList.remove('sel'));
  S.file=file;S.selectedExample=null;
  const reader=new FileReader();
  reader.onload=e=>{
    S.source=e.target.result||'';
    renderCode(S.source,file.name);
    setText('meta-lines',S.source.split('\n').length);
    setText('meta-findings','‚Äî');setText('meta-grade','‚Äî');
    const btn=document.getElementById('scan-btn');
    btn.disabled=false;
    btn.innerHTML=`<svg viewBox="0 0 20 20" fill="none"><circle cx="10" cy="10" r="7" stroke="currentColor" stroke-width="1.5"/><path d="M10 7v3l2 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>RUN QUANTUM SCAN`;
  };
  reader.readAsText(file);
}

/* drag-drop */
document.addEventListener('DOMContentLoaded',()=>{
  const z=document.getElementById('upload-z');
  if(!z)return;
  z.addEventListener('dragover',e=>{e.preventDefault();z.classList.add('dov')});
  z.addEventListener('dragleave',()=>z.classList.remove('dov'));
  z.addEventListener('drop',e=>{
    e.preventDefault();z.classList.remove('dov');
    const f=e.dataTransfer.files[0];
    if(f)handleUpload({target:{files:[f]}});
  });
});

/* ‚îÄ‚îÄ CODE VIEWER ‚îÄ‚îÄ */
const VULN_KW=['rsa','sha1','sha-1','des','md5','rc4','dh-','ecdsa','ecdh','p-256','p256','prime256','rs256','rs384','rs512','es256'];
const SAFE_KW=['aes-256','sha-3','sha3','sha256','ml-kem','ml-dsa','argon2','chacha20','blake2','kyber'];

function renderCode(source, filename){
  const body=document.getElementById('code-body');
  const cvFile=document.getElementById('cv-file');
  const cvCounts=document.getElementById('cv-counts');
  if(!body)return;
  if(cvFile)cvFile.textContent=filename;
  const lines=source.split('\n').slice(0,300);
  let vCount=0,sCount=0;
  const html=lines.map((text,i)=>{
    const lo=text.toLowerCase();
    const isV=VULN_KW.some(k=>lo.includes(k));
    const isS=!isV&&SAFE_KW.some(k=>lo.includes(k));
    if(isV)vCount++;
    if(isS)sCount++;
    const cls=isV?'cl vuln':isS?'cl safe-l':'cl';
    return `<div class="${cls}"><span class="ln">${i+1}</span><span class="lc">${esc(text)||' '}</span></div>`;
  }).join('');
  body.innerHTML=html||'<div class="code-empty-state"><div class="ces-icon">‚óà</div><span>Empty file</span></div>';
  if(cvCounts)cvCounts.innerHTML=`
    ${vCount?`<span class="cv-badge cvb-bad">${vCount} vulnerable</span>`:''}
    ${sCount?`<span class="cv-badge cvb-ok">${sCount} safe</span>`:''}
  `;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   RUN SCAN  ‚Üí  POST /scan
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
async function runScan(){
  if(!S.file)return;
  const overlay=document.getElementById('loverlay');
  const lbar=document.getElementById('lm-bar');
  const lpct=document.getElementById('lm-pct');
  const lsub=document.getElementById('lm-sub');
  overlay.classList.add('on');
  lbar.style.width='0%';

  const steps=['Uploading file‚Ä¶','Detecting cryptographic primitives‚Ä¶','Running static analysis‚Ä¶','Invoking AI explanation engine‚Ä¶','Generating PQC migration diffs‚Ä¶','Calculating risk score‚Ä¶'];
  let fake=0,stepIdx=0;
  const timer=setInterval(()=>{
    fake=Math.min(fake+(Math.random()*3.5+1),88);
    lbar.style.width=fake+'%';
    if(lpct)lpct.textContent=Math.round(fake)+'%';
    if(lsub&&Math.random()<0.15){
      lsub.textContent=steps[Math.min(stepIdx++,steps.length-1)];
    }
  },130);

  document.getElementById('scan-btn').disabled=true;
  const pw=document.getElementById('prog-wrap');
  if(pw)pw.style.display='block';

  try{
    const fd=new FormData();
    fd.append('file',S.file);
    const resp=await fetch(API+'/scan',{method:'POST',body:fd});
    clearInterval(timer);
    if(!resp.ok){
      const err=await resp.json().catch(()=>({detail:'HTTP '+resp.status}));
      throw new Error(err.detail||'HTTP '+resp.status);
    }
    const data=await resp.json();
    S.results=data;
    lbar.style.width='100%';
    if(lpct)lpct.textContent='100%';
    if(lsub)lsub.textContent=`${data.length} finding(s) processed.`;
    setTimeout(()=>{
      overlay.classList.remove('on');
      document.getElementById('scan-btn').disabled=false;
      if(pw)pw.style.display='none';
      renderResults(data);
    },600);
  } catch(err){
    clearInterval(timer);
    overlay.classList.remove('on');
    document.getElementById('scan-btn').disabled=false;
    if(pw)pw.style.display='none';
    const area=document.getElementById('results-area');
    area.innerHTML=`<div class="scan-error">
      ‚ö† SCAN FAILED: ${esc(String(err))}<br>
      <span style="color:var(--text3);font-size:10px;margin-top:6px;display:block">
        Make sure the backend is running: <code style="color:var(--cyan)">cd backend && uvicorn main:app --reload</code><br>
        Backend URL: ${API}
      </span>
    </div>`;
  }
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   RENDER RESULTS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function renderResults(results){
  const area=document.getElementById('results-area');
  if(!results||!results.length){
    area.innerHTML=`<div class="scan-success"><div class="ss-check">‚úÖ</div><strong>No quantum-vulnerable algorithms detected!</strong><span style="font-size:11px;color:var(--text2)">This file appears to use safe cryptographic primitives.</span></div>`;
    return;
  }

  const grading=results[0]?.grading;
  const posture=grading?.overall_security_posture||{};
  const summary=grading?.summary||{};
  const safeAlgos=grading?.quantum_safe_algorithms||[];

  // Update scan meta
  const total=summary.total??results.length;
  setText('meta-findings',total);
  const grade=posture.grade||'‚Äî';
  const gradeEl=document.getElementById('meta-grade');
  if(gradeEl){
    gradeEl.textContent=grade;
    gradeEl.style.color=['F','D'].includes(grade)?'var(--red)':grade==='C'?'var(--orange)':'var(--green)';
  }

  // Grade colours
  const gradeColor={'A':'var(--green)','B':'var(--green)','C':'var(--orange)','D':'var(--red)','F':'var(--red)'}[grade]||'var(--text2)';
  const badgeCls=posture.compliance_badge||'MODERATE_RISK';

  let html='';

  /* ‚îÄ‚îÄ POSTURE BANNER ‚îÄ‚îÄ */
  html+=`<div class="posture-banner ${badgeCls}">
    <div class="pb-grade" style="color:${gradeColor}">${grade}</div>
    <div class="pb-info">
      <div class="pb-readiness" style="color:${gradeColor}">${posture.quantum_readiness||'UNKNOWN'}</div>
      <div class="pb-score">Risk Score: ${posture.risk_score??'‚Äî'}/100 ¬∑ ${badgeCls.replace(/_/g,' ')}</div>
      <div class="pb-pills">
        ${(summary.critical||0)?`<span class="pb-pill" style="background:rgba(239,68,68,0.12);border:1px solid rgba(239,68,68,0.3);color:var(--red)">${summary.critical} CRITICAL</span>`:''}
        ${(summary.high||0)?`<span class="pb-pill" style="background:rgba(245,158,11,0.1);border:1px solid rgba(245,158,11,0.28);color:var(--orange)">${summary.high} HIGH</span>`:''}
        ${(summary.medium||0)?`<span class="pb-pill" style="background:rgba(252,211,77,0.08);border:1px solid rgba(252,211,77,0.25);color:var(--yellow)">${summary.medium} MEDIUM</span>`:''}
        ${(summary.low||0)?`<span class="pb-pill" style="background:rgba(16,185,129,0.08);border:1px solid rgba(16,185,129,0.22);color:var(--green)">${summary.low} LOW</span>`:''}
        ${safeAlgos.length?`<span class="pb-pill" style="background:rgba(34,211,238,0.08);border:1px solid rgba(34,211,238,0.22);color:var(--cyan)">${safeAlgos.length} SAFE</span>`:''}
      </div>
    </div>
  </div>`;

  /* ‚îÄ‚îÄ CHARTS ROW ‚îÄ‚îÄ */
  const riskScore=posture.risk_score??0;
  const fixedScore=Math.max(0,riskScore-Math.round(riskScore*0.65));
  const critN=summary.critical??0,highN=summary.high??0,medN=summary.medium??0,lowN=summary.low??0;
  html+=`<div class="charts-row">
    <div class="chart-card">
      <div class="chart-hd">VULNERABILITY BREAKDOWN</div>
      <canvas id="donut-canvas" width="130" height="130" style="display:block;margin:0 auto"></canvas>
      <div class="donut-legend" id="donut-legend"></div>
      <div class="chart-sub">${total} total finding${total!==1?'s':''} detected</div>
    </div>
    <div class="chart-card">
      <div class="chart-hd">RISK SCORE</div>
      <div class="meter-svg-wrap"><canvas id="meter-canvas" width="200" height="110"></canvas></div>
      <div class="meter-readout">
        <div class="mr-val" style="color:${gradeColor}">${riskScore}</div>
        <div class="mr-lbl">/ 100 ¬∑ ${badgeCls.replace(/_/g,' ')}</div>
      </div>
    </div>
    <div class="chart-card">
      <div class="chart-hd">RISK BEFORE ‚Üí AFTER MIGRATION</div>
      <div class="ba-rows">
        <div class="ba-block">
          <div class="ba-hd">
            <span class="ba-lbl">BEFORE (current)</span>
            <span class="ba-score" style="color:${gradeColor}">${riskScore}/100</span>
          </div>
          <div class="ba-track">
            <div class="ba-fill" id="ba-before" style="width:0%;background:linear-gradient(90deg,#DC2626,var(--red))">
              <span>${riskScore}%</span>
            </div>
          </div>
        </div>
        <div class="ba-block">
          <div class="ba-hd">
            <span class="ba-lbl">AFTER full PQC migration</span>
            <span class="ba-score" style="color:var(--green)">${fixedScore}/100</span>
          </div>
          <div class="ba-track">
            <div class="ba-fill" id="ba-after" style="width:0%;background:linear-gradient(90deg,#059669,var(--green))">
              <span>${fixedScore}%</span>
            </div>
          </div>
        </div>
        <div class="ba-improvement">
          <div class="ba-imp-num">‚Üì ${riskScore-fixedScore}</div>
          <div class="ba-imp-lbl">RISK POINTS ELIMINATED</div>
        </div>
      </div>
    </div>
  </div>`;

  /* ‚îÄ‚îÄ FINDINGS ‚îÄ‚îÄ */
  const findings=results.filter(r=>r.finding?.severity!=='INFO'||results.length===1);
  const hasFindings=findings.some(r=>r.finding?.severity!=='INFO');

  if(!hasFindings){
    html+=`<div class="scan-success"><div class="ss-check">‚úÖ</div><strong>No quantum-vulnerable algorithms detected!</strong><span style="font-size:11px;color:var(--text2)">This file uses quantum-safe cryptographic primitives.</span></div>`;
  } else {
    html+=`<div class="findings-section-hd">
      <div class="findings-hd-title">‚ö° Detailed Findings & AI-Generated Fixes</div>
      <div class="findings-count">${findings.length} issue${findings!==1?'s':''} ¬∑ click to expand</div>
    </div>
    <div class="findings-list" id="findings-list">`;
    findings.forEach((item,i)=>{
      if(item.finding?.severity==='INFO')return;
      html+=renderFindingCard(item,i);
    });
    html+=`</div>`;
  }

  area.innerHTML=html;

  /* ‚îÄ‚îÄ animate charts ‚îÄ‚îÄ */
  requestAnimationFrame(()=>{
    drawDonut(critN,highN,medN,lowN);
    drawMeter(riskScore);
    const bb=document.getElementById('ba-before');
    const ba=document.getElementById('ba-after');
    setTimeout(()=>{
      if(bb)bb.style.width=Math.min(riskScore,100)+'%';
      if(ba)ba.style.width=Math.min(fixedScore,100)+'%';
    },60);
    // init diff tabs
    document.querySelectorAll('.diff-tab').forEach(t=>{
      t.onclick=()=>{
        const container=t.closest('.fix-section');
        container.querySelectorAll('.diff-tab').forEach(x=>x.classList.remove('on'));
        container.querySelectorAll('.diff-pane').forEach(x=>x.classList.remove('on'));
        t.classList.add('on');
        container.querySelector('.diff-pane[data-pane="'+t.dataset.tab+'"]').classList.add('on');
      };
    });
  });
}

/* ‚îÄ‚îÄ FINDING CARD HTML ‚îÄ‚îÄ */
function renderFindingCard(item,idx){
  const f=item.finding||{};
  const fix=item.fix||{};
  const sev=(f.severity||'LOW');
  const diff=fix.diff||'';
  const diffLines=diff.split('\n').map(line=>{
    if(line.startsWith('@@'))return `<div class="diff-l hunk">${esc(line)}</div>`;
    if(line.startsWith('---')||line.startsWith('+++'))return `<div class="diff-l head">${esc(line)}</div>`;
    if(line.startsWith('-'))return `<div class="diff-l minus">${esc(line)}</div>`;
    if(line.startsWith('+'))return `<div class="diff-l plus">${esc(line)}</div>`;
    return `<div class="diff-l ctx">${esc(line)}</div>`;
  }).join('');

  return `<div class="finding-card sev-${sev}" style="animation-delay:${idx*0.07}s">
    <div class="fc-head">
      <div class="fc-left">
        <div class="fc-id-row">
          <span class="fc-id">${esc(f.id||'‚Äî')}</span>
          ${f.cve?`<span class="fc-cve">¬∑ ${esc(f.cve)}</span>`:''}
        </div>
        <div class="fc-algo">${esc(f.algorithm||'‚Äî')}</div>
        <div class="fc-desc">${esc(f.description||'')}</div>
        ${f.line?`<div class="fc-loc">Line ${f.line}${f.col?`, col ${f.col}`:''} ¬∑ <code style="color:var(--cyan);font-size:10px">${esc(f.code||'')}</code></div>`:''}
      </div>
      <span class="sev-b sb-${sev}">${sev}</span>
    </div>
    <div class="fc-body">
      ${item.explanation?`<div class="ai-explain">${esc(item.explanation)}</div>`:''}
      ${fix.pqc_algo?`<div class="fix-section">
        <div class="fix-header">
          <div class="fix-hd-left">
            <span class="fix-lbl">REPLACE WITH</span>
            <span style="color:var(--text3);font-size:11px">‚Üí</span>
            <span class="fix-algo-name">${esc(fix.pqc_algo)}</span>
          </div>
          <div class="fix-meta-badges">
            ${fix.standard?`<span class="fix-meta-b fmb-std">${esc(fix.standard)}</span>`:''}
            ${fix.perf_impact?`<span class="fix-meta-b fmb-perf">${esc(fix.perf_impact)} overhead</span>`:''}
            <span class="fix-meta-b fmb-pqc">PQC SAFE</span>
          </div>
        </div>
        <div class="diff-tabs">
          <button class="diff-tab on" data-tab="diff">CODE DIFF</button>
          <button class="diff-tab" data-tab="info">MIGRATION NOTES</button>
        </div>
        <div class="diff-pane on" data-pane="diff">
          ${diff?diffLines:`<div class="diff-l ctx" style="padding:14px;color:var(--text3)">No diff available for this finding.</div>`}
        </div>
        <div class="diff-pane" data-pane="info">
          <div style="padding:14px;font-size:12px;color:var(--text2);line-height:1.7">
            <strong style="color:var(--text);font-family:var(--font-h)">How to migrate:</strong><br>
            Replace <code style="color:var(--red)">${esc(f.algorithm||'this algorithm')}</code> with <code style="color:var(--green)">${esc(fix.pqc_algo||'')}</code>.<br><br>
            ${fix.standard?`<strong style="color:var(--text)">Standard:</strong> ${esc(fix.standard)} (NIST PQC finalised Aug 2024)<br>`:''}
            ${fix.perf_impact?`<strong style="color:var(--text)">Performance overhead:</strong> ${esc(fix.perf_impact)} ‚Äî acceptable for most use-cases<br>`:''}
            <br>This is a <strong style="color:var(--cyan)">drop-in replacement</strong>. The API surface remains the same; only the underlying algorithm changes.
          </div>
        </div>
      </div>`:''}
    </div>
  </div>`;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   CANVAS: DONUT CHART
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function drawDonut(crit,high,med,low){
  const canvas=document.getElementById('donut-canvas');
  if(!canvas)return;
  const ctx=canvas.getContext('2d');
  const W=130,H=130,cx=W/2,cy=H/2,r=50,inner=28;
  ctx.clearRect(0,0,W,H);

  const data=[
    {v:crit,color:'#EF4444',label:'Critical'},
    {v:high,color:'#F59E0B',label:'High'},
    {v:med,color:'#FCD34D',label:'Medium'},
    {v:low,color:'#10B981',label:'Low'},
  ].filter(d=>d.v>0);

  if(!data.length){
    ctx.beginPath();ctx.arc(cx,cy,r,0,Math.PI*2);
    ctx.strokeStyle='rgba(255,255,255,0.06)';ctx.lineWidth=22;ctx.stroke();
    const leg=document.getElementById('donut-legend');
    if(leg)leg.innerHTML='<span style="font-family:var(--font-m);font-size:9px;color:var(--text3)">NO FINDINGS</span>';
    return;
  }

  const total=data.reduce((s,d)=>s+d.v,0);
  let angle=-Math.PI/2;
  data.forEach(d=>{
    const slice=(d.v/total)*Math.PI*2;
    ctx.beginPath();
    ctx.arc(cx,cy,r,angle,angle+slice);
    ctx.arc(cx,cy,inner,angle+slice,angle,true);
    ctx.closePath();
    ctx.fillStyle=d.color;
    ctx.fill();
    angle+=slice;
  });

  // center text
  ctx.fillStyle='#E2E8F0';
  ctx.font='bold 16px Syne,sans-serif';
  ctx.textAlign='center';ctx.textBaseline='middle';
  ctx.fillText(total,cx,cy-7);
  ctx.fillStyle='#475569';
  ctx.font='9px Space Mono,monospace';
  ctx.fillText('TOTAL',cx,cy+9);

  const leg=document.getElementById('donut-legend');
  if(leg)leg.innerHTML=data.map(d=>`
    <div class="dl-item">
      <div class="dl-dot" style="background:${d.color}"></div>
      ${d.v} ${d.label}
    </div>`).join('');
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   CANVAS: RISK METER (arc gauge)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function drawMeter(score){
  const canvas=document.getElementById('meter-canvas');
  if(!canvas)return;
  const ctx=canvas.getContext('2d');
  const W=200,H=110,cx=100,cy=95,r=70;
  ctx.clearRect(0,0,W,H);
  const startA=Math.PI,endA=2*Math.PI;

  // track
  ctx.beginPath();ctx.arc(cx,cy,r,startA,endA);
  ctx.strokeStyle='rgba(255,255,255,0.05)';ctx.lineWidth=14;ctx.lineCap='round';ctx.stroke();

  // coloured fill
  const progress=Math.min(score/100,1);
  const fillA=startA+progress*Math.PI;
  const color=score>=75?'#EF4444':score>=50?'#F59E0B':score>=25?'#FCD34D':'#10B981';
  const grad=ctx.createLinearGradient(cx-r,cy,cx+r,cy);
  grad.addColorStop(0,'#10B981');
  grad.addColorStop(0.5,'#F59E0B');
  grad.addColorStop(1,'#EF4444');
  ctx.beginPath();ctx.arc(cx,cy,r,startA,fillA);
  ctx.strokeStyle=grad;ctx.lineWidth=14;ctx.lineCap='round';ctx.stroke();

  // needle
  const needleA=startA+progress*Math.PI;
  const nx=cx+Math.cos(needleA)*(r-6);
  const ny=cy+Math.sin(needleA)*(r-6);
  ctx.beginPath();ctx.moveTo(cx,cy);ctx.lineTo(nx,ny);
  ctx.strokeStyle='#E2E8F0';ctx.lineWidth=2;ctx.lineCap='round';ctx.stroke();
  ctx.beginPath();ctx.arc(cx,cy,5,0,Math.PI*2);ctx.fillStyle='#E2E8F0';ctx.fill();

  // labels
  ctx.font='9px Space Mono,monospace';ctx.fillStyle='#10B981';ctx.textAlign='center';
  ctx.fillText('0',cx-r-6,cy+4);
  ctx.fillStyle='#EF4444';
  ctx.fillText('100',cx+r+10,cy+4);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   UTILS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function setText(id,val){const el=document.getElementById(id);if(el)el.textContent=val;}
function esc(s){return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');}
</script>
</body>
</html>
